<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<title>Advanced Mini Music Player</title>
<style>
:root {
  --bg-dark: #151522;
  --bg-light: #f1f1f1;
  --text-dark: #fff;
  --text-light: #000;
  --accent: #7c5cff;
}

body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: var(--bg-dark);
  color: var(--text-dark);
}

.music-player {
  width: 360px;
  background: rgba(30,30,50,0.85);
  padding: 20px;
  border-radius: 25px;
  box-shadow: 0 0 30px rgba(124,92,255,0.5);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.song-img {
  width: 260px;
  height: 260px;
  border-radius: 20px;
  object-fit: cover;
  margin-bottom: 15px;
  transition: transform 0.5s ease;
}
.rotating { animation: rotate 10s linear infinite; }
@keyframes rotate { 0%{transform: rotate(0deg);} 100%{transform: rotate(360deg);} }

h1 { margin: 5px 0; font-size: 1.2rem; text-align: center; }
p { margin: 0 0 10px; color: #aaa; text-align: center; font-size: 0.9rem; }

.controls, .extra-controls { display: flex; justify-content: center; gap: 20px; margin: 10px 0; }
.controls div, .extra-controls div { cursor: pointer; font-size: 26px; transition: 0.3s; }
.controls div:hover, .extra-controls div:hover { color: var(--accent); transform: scale(1.2); }

input[type=range] {
  width: 100%;
  margin: 5px 0;
  -webkit-appearance: none;
  background: linear-gradient(90deg, var(--accent) 0%, var(--accent) 50%, #555 50%, #555 100%);
  height: 6px;
  border-radius: 3px;
  outline: none;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px; height: 16px;
  border-radius: 50%;
  background: var(--accent);
  cursor: pointer;
  transition: transform 0.2s;
}
input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.3); }

.time { display: flex; justify-content: space-between; font-size: 0.8rem; color: #aaa; }

.song-list { width: 100%; max-height: 160px; overflow-y: auto; margin-top: 15px; display: flex; flex-direction: column; gap: 5px; }
.song-item {
  display: flex; align-items: center; gap: 10px;
  padding: 7px; border-radius: 10px; cursor: grab;
  transition: 0.3s; background: transparent;
}
.song-item img { width: 40px; height: 40px; border-radius: 8px; object-fit: cover; }
.song-item.active { background: rgba(124,92,255,0.2); font-weight: bold; color: var(--accent);}
.song-item:hover { background: rgba(124,92,255,0.1); }

.search-bar input {
  width: 100%; padding: 7px; border-radius: 10px;
  border: none; outline: none; margin-bottom: 10px;
}

.eq-container { display: flex; justify-content: center; align-items: flex-end; gap: 3px; height: 50px; margin: 10px 0; }
.eq-bar { width: 4px; background: var(--accent); transition: height 0.1s; }
</style>
</head>
<body>

<div class="music-player">
  <img src="" class="song-img" id="songImg">
  <h1 id="songTitle">Song Title</h1>
  <p id="songArtist">Artist</p>

  <audio id="song"></audio>

  <div class="time">
    <span id="currentTime">0:00</span>
    <span id="duration">0:00</span>
  </div>
  <input type="range" id="progress" value="0" min="0" step="0.1">
  <input type="range" id="volume" value="1" min="0" max="1" step="0.01">

  <div class="controls">
    <div id="prev"><i class="fa-solid fa-backward"></i></div>
    <div id="playPause"><i class="fa-solid fa-play" id="ctrlIcon"></i></div>
    <div id="next"><i class="fa-solid fa-forward"></i></div>
  </div>

  <div class="extra-controls">
    <div id="shuffle"><i class="fa-solid fa-shuffle"></i></div>
    <div id="repeat"><i class="fa-solid fa-repeat"></i></div>
  </div>

  <div class="search-bar">
    <input type="text" id="search" placeholder="Поиск песни...">
  </div>

  <div class="eq-container" id="eqContainer"></div>

  <div class="song-list" id="songList"></div>
</div>

<script>
const songs = [
{ name: "Bedelen", artist: "Verzetsstrijder", file: "media/Verzetsstrijder - Bedelen.mp3", img: "media/df87ec8840d3b6c72cdbc3e0b9eb1222.jpg" },
  { name: "Гной", artist: "Темный принц", file: "media/тёмный принц - гной.mp3", img: "media/22e5b9d46527aec1bee62532aa6afa25.jpg" },
  { name: "Вклубе", artist: "Темный принц", file: "media/тёмный принц - вклубе.mp3", img: "media/9dbb7a54843b5e0fe46a580fd96a0aaa.jpg" },
  { name: "Цветы", artist: "Темный принц", file: "media/тёмный принц - цветы.mp3", img: "media/a5afe5f75ebb60e02232079d78d5101b.jpg" },
  { name: "No, The Moon", artist: "Teen Suicide", file: "media/teen suicide - no, the moon.mp3", img: "media/65c3aa1d18e09eb1c525cc8ecf5e6ab2.jpg" },
  { name: "Комнатный", artist: "Хочу побыть один", file: "media/Комнатный - хочу побыть один (p. seicun).mp3", img: "media/1dca05ae4a33081de80eb8b7953fed77.png" },
  { name: "Комнатный", artist: "Cамая плохая ты", file: "media/Комнатный - Самая плохая ты (p. seicun).mp3", img: "media/783de8b2a31ab841a2cd5ae93cecdf11.jpg" },
  { name: "Комнатный", artist: "аптека ребята", file: "media/Комнатный - аптека ребята.mp3", img: "media/7c4c423ab1c32fcb06fbe92f86369447.jpg" },
  { name: "Мажоры (Remix)", artist: "Lil Morty, Yunggokrazy", file: "media/Lil Morty, Yunggokrazy - Мажоры (Remix).mp3", img: "media/db60197a6a0665e9e650432bb99d828c.jpg" },
  { name: "shalawa", artist: "tuborosho", file: "media/tuborosho - shalawa.mp3", img: "media/e7b3065faf26605ee5af99c9bab32a23.jpg" },
  { name: "вконтакте", artist: "хинков", file: "media/хинков - вконтакте.mp3", img: "media/da3e478b7c474582ac9ce85b4889f99e.jpg" },
  { name: "крепче (Sped Up)", artist: "whyspurky", file: "media/whyspurky - крепче (Sped Up).mp3", img: "media/854ab3aba4534367e834b5e9c1ee1291.jpg" },
  { name: "нужна", artist: "M'Dee", file: "media/M'Dee - нужна.mp3", img: "media/5a3b4585129040bcf3e2d4466b8f7b6e.jpg" },
  { name: "I Wont Let Anyone Take This Revenge Away from Me.", artist: "pione", file: "media/pione - I Wont Let Anyone Take This Revenge Away from Me..mp3", img: "media/db60197a6a0665e9e650432bb99d828c.jpg" },
  { name: "Munchausen Syndrome Hardstyle (Slowed)", artist: "HARDSTYLE CVNT", file: "media/HARDSTYLE CVNT - Munchausen Syndrome Hardstyle (Slowed).mp3", img: "media/df87ec8840d3b6c72cdbc3e0b9eb1222.jpg" },
  { name: "Рядом С Тобой", artist: "GONE.Fludd, m00nchild", file: "media/GONE.Fludd, m00nchild - Рядом С Тобой.mp3", img: "media/7b1d56e37cecc27de6f9f5bd7dea705d.jpg" },
  { name: "Unslept", artist: "Miraidempa ", file: "media/Miraidempa - Unslept.mp3", img: "media/8b4d69a5d84da3fddca863bf5e2db685.jpg" },
  { name: "Любовь HD1080", artist: "Каспийский Груз ", file: "media/Каспийский Груз - Любовь HD1080.mp3", img: "media/db5c6c6dce7e4757d213c43091abb9f2.jpg" },
];

let songIndex = 0, isShuffle=false, isRepeat=false;
const song = document.getElementById("song");
const progress = document.getElementById("progress");
const volume = document.getElementById("volume");
const ctrlIcon = document.getElementById("ctrlIcon");
const songTitle = document.getElementById("songTitle");
const songArtist = document.getElementById("songArtist");
const songImg = document.getElementById("songImg");
const songListEl = document.getElementById("songList");
const currentTimeEl = document.getElementById("currentTime");
const durationEl = document.getElementById("duration");
const shuffleBtn = document.getElementById("shuffle");
const repeatBtn = document.getElementById("repeat");
const searchInput = document.getElementById("search");
const eqContainer = document.getElementById("eqContainer");

let draggedIndex = null;

// EQ Bars
const eqBars = [];
for(let i=0;i<20;i++){
  const bar = document.createElement("div");
  bar.classList.add("eq-bar");
  eqContainer.appendChild(bar);
  eqBars.push(bar);
}

// Render song list with drag & drop
function renderSongList(filter=""){
  songListEl.innerHTML="";
  songs.forEach((s,i)=>{
    if(!s.name.toLowerCase().includes(filter.toLowerCase()) && !s.artist.toLowerCase().includes(filter.toLowerCase())) return;
    const div = document.createElement("div");
    div.className="song-item";
    if(i===songIndex) div.classList.add("active");
    div.draggable=true;
    div.innerHTML=`<img src="${s.img}"><span>${s.name}</span>`;
    
    div.addEventListener("click",()=>{ songIndex=i; loadSong(i); song.play(); updatePlayPauseIcon(); });
    div.addEventListener("dragstart",()=>{ draggedIndex=i; });
    div.addEventListener("dragover",(e)=>{ e.preventDefault(); });
    div.addEventListener("drop",()=>{ 
      const temp = songs[i]; songs[i]=songs[draggedIndex]; songs[draggedIndex]=temp;
      renderSongList(searchInput.value);
    });
    songListEl.appendChild(div);
  });
}
renderSongList();

function updateActiveSong(){
  document.querySelectorAll(".song-item").forEach((el,i)=>{ el.classList.toggle("active", i===songIndex); });
}

function loadSong(index){
  song.src=songs[index].file;
  songTitle.textContent=songs[index].name;
  songArtist.textContent=songs[index].artist;
  songImg.src=songs[index].img;
  song.currentTime=0;
  progress.value=0;
  updateActiveSong();
  updatePlayPauseIcon();
  songImg.classList.remove("rotating");
  setTimeout(()=>{ if(!song.paused) songImg.classList.add("rotating"); },100);
}

function playPause(){
  if(song.paused){ song.play(); songImg.classList.add("rotating"); }
  else { song.pause(); songImg.classList.remove("rotating"); }
  updatePlayPauseIcon();
}

function updatePlayPauseIcon(){
  ctrlIcon.classList.replace(song.paused?"fa-pause":"fa-play",song.paused?"fa-play":"fa-pause");
}

function nextSong(){
  if(isShuffle) songIndex=Math.floor(Math.random()*songs.length);
  else songIndex=(songIndex+1)%songs.length;
  loadSong(songIndex);
  song.play();
  updatePlayPauseIcon();
}

function prevSong(){ songIndex=(songIndex-1+songs.length)%songs.length; loadSong(songIndex); song.play(); updatePlayPauseIcon(); }

function formatTime(t){ const m=Math.floor(t/60); const s=Math.floor(t%60); return `${m}:${s<10?'0'+s:s}`; }

song.ontimeupdate=function(){
  progress.max=song.duration||0;
  progress.value=song.currentTime;
  currentTimeEl.textContent=formatTime(song.currentTime);
  durationEl.textContent=formatTime(song.duration||0);
  progress.style.background=`linear-gradient(90deg, var(--accent) ${song.currentTime/song.duration*100}%, #555 ${song.currentTime/song.duration*100}%)`;
  
  // Simple EQ visualization
  eqBars.forEach((bar,i)=>bar.style.height=(Math.random()*song.volume*50+10)+'px');
}

progress.addEventListener("input",()=>song.currentTime=progress.value);
volume.addEventListener("input",()=>song.volume=volume.value);
document.getElementById("playPause").addEventListener("click",playPause);
document.getElementById("next").addEventListener("click",nextSong);
document.getElementById("prev").addEventListener("click",prevSong);

shuffleBtn.addEventListener("click",()=>{ isShuffle=!isShuffle; shuffleBtn.style.color=isShuffle? '#7c5cff':'white'; });
repeatBtn.addEventListener("click",()=>{ isRepeat=!isRepeat; repeatBtn.style.color=isRepeat? '#7c5cff':'white'; });

song.addEventListener("ended",()=>{ if(isRepeat){ song.currentTime=0; song.play(); } else nextSong(); });

searchInput.addEventListener("input",()=>renderSongList(searchInput.value));

window.onload=()=>{ loadSong(songIndex); };
</script>

</body>
</html>

